import{feature as e,lineString as r,isObject as t,point as n}from"@turf/helpers";function coordEach(e,r,t){if(e!==null){var n,o,a,i,l,u,s,c,f=0,g=0,h=e.type,d=h==="FeatureCollection",v=h==="Feature",y=d?e.features.length:1;for(var p=0;p<y;p++){s=d?e.features[p].geometry:v?e.geometry:e;c=!!s&&s.type==="GeometryCollection";l=c?s.geometries.length:1;for(var m=0;m<l;m++){var P=0;var E=0;i=c?s.geometries[m]:s;if(i!==null){u=i.coordinates;var w=i.type;f=!t||w!=="Polygon"&&w!=="MultiPolygon"?0:1;switch(w){case null:break;case"Point":if(r(u,g,p,P,E)===false)return false;g++;P++;break;case"LineString":case"MultiPoint":for(n=0;n<u.length;n++){if(r(u[n],g,p,P,E)===false)return false;g++;w==="MultiPoint"&&P++}w==="LineString"&&P++;break;case"Polygon":case"MultiLineString":for(n=0;n<u.length;n++){for(o=0;o<u[n].length-f;o++){if(r(u[n][o],g,p,P,E)===false)return false;g++}w==="MultiLineString"&&P++;w==="Polygon"&&E++}w==="Polygon"&&P++;break;case"MultiPolygon":for(n=0;n<u.length;n++){E=0;for(o=0;o<u[n].length;o++){for(a=0;a<u[n][o].length-f;a++){if(r(u[n][o][a],g,p,P,E)===false)return false;g++}E++}P++}break;case"GeometryCollection":for(n=0;n<i.geometries.length;n++)if(coordEach(i.geometries[n],r,t)===false)return false;break;default:throw new Error("Unknown Geometry Type")}}}}}}function coordReduce(e,r,t,n){var o=t;coordEach(e,(function(e,n,a,i,l){o=n===0&&t===void 0?e:r(o,e,n,a,i,l)}),n);return o}function propEach(e,r){var t;switch(e.type){case"FeatureCollection":for(t=0;t<e.features.length;t++)if(r(e.features[t].properties,t)===false)break;break;case"Feature":r(e.properties,0);break}}function propReduce(e,r,t){var n=t;propEach(e,(function(e,o){n=o===0&&t===void 0?e:r(n,e,o)}));return n}function featureEach(e,r){if(e.type==="Feature")r(e,0);else if(e.type==="FeatureCollection")for(var t=0;t<e.features.length;t++)if(r(e.features[t],t)===false)break}function featureReduce(e,r,t){var n=t;featureEach(e,(function(e,o){n=o===0&&t===void 0?e:r(n,e,o)}));return n}function coordAll(e){var r=[];coordEach(e,(function(e){r.push(e)}));return r}function geomEach(e,r){var t,n,o,a,i,l,u,s,c,f,g=0,h=e.type==="FeatureCollection",d=e.type==="Feature",v=h?e.features.length:1;for(t=0;t<v;t++){l=h?e.features[t].geometry:d?e.geometry:e;s=h?e.features[t].properties:d?e.properties:{};c=h?e.features[t].bbox:d?e.bbox:void 0;f=h?e.features[t].id:d?e.id:void 0;u=!!l&&l.type==="GeometryCollection";i=u?l.geometries.length:1;for(o=0;o<i;o++){a=u?l.geometries[o]:l;if(a!==null)switch(a.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(r(a,g,s,c,f)===false)return false;break;case"GeometryCollection":for(n=0;n<a.geometries.length;n++)if(r(a.geometries[n],g,s,c,f)===false)return false;break;default:throw new Error("Unknown Geometry Type")}else if(r(null,g,s,c,f)===false)return false}g++}}function geomReduce(e,r,t){var n=t;geomEach(e,(function(e,o,a,i,l){n=o===0&&t===void 0?e:r(n,e,o,a,i,l)}));return n}function flattenEach(r,t){geomEach(r,(function(r,n,o,a,i){var l=r===null?null:r.type;switch(l){case null:case"Point":case"LineString":case"Polygon":return t(e(r,o,{bbox:a,id:i}),n,0)!==false&&void 0}var u;switch(l){case"MultiPoint":u="Point";break;case"MultiLineString":u="LineString";break;case"MultiPolygon":u="Polygon";break}for(var s=0;s<r.coordinates.length;s++){var c=r.coordinates[s];var f={type:u,coordinates:c};if(t(e(f,o),n,s)===false)return false}}))}function flattenReduce(e,r,t){var n=t;flattenEach(e,(function(e,o,a){n=o===0&&a===0&&t===void 0?e:r(n,e,o,a)}));return n}function segmentEach(e,t){flattenEach(e,(function(e,n,o){var a=0;if(e.geometry){var i=e.geometry.type;if(i!=="Point"&&i!=="MultiPoint"){var l;var u=0;var s=0;var c=0;return coordEach(e,(function(i,f,g,h,d){if(l===void 0||n>u||h>s||d>c){l=i;u=n;s=h;c=d;a=0}else{var v=r([l,i],e.properties);if(t(v,n,o,d,a)===false)return false;a++;l=i}}))!==false&&void 0}}}))}function segmentReduce(e,r,t){var n=t;var o=false;segmentEach(e,(function(e,a,i,l,u){n=o===false&&t===void 0?e:r(n,e,a,i,l,u);o=true}));return n}function lineEach(e,t){if(!e)throw new Error("geojson is required");flattenEach(e,(function(e,n,o){if(e.geometry!==null){var a=e.geometry.type;var i=e.geometry.coordinates;switch(a){case"LineString":if(t(e,n,o,0,0)===false)return false;break;case"Polygon":for(var l=0;l<i.length;l++)if(t(r(i[l],e.properties),n,o,l)===false)return false;break}}}))}function lineReduce(e,r,t){var n=t;lineEach(e,(function(e,o,a,i){n=o===0&&t===void 0?e:r(n,e,o,a,i)}));return n}function findSegment(e,n){n=n||{};if(!t(n))throw new Error("options is invalid");var o=n.featureIndex||0;var a=n.multiFeatureIndex||0;var i=n.geometryIndex||0;var l=n.segmentIndex||0;var u=n.properties;var s;switch(e.type){case"FeatureCollection":o<0&&(o=e.features.length+o);u=u||e.features[o].properties;s=e.features[o].geometry;break;case"Feature":u=u||e.properties;s=e.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":s=e;break;default:throw new Error("geojson is invalid")}if(s===null)return null;var c=s.coordinates;switch(s.type){case"Point":case"MultiPoint":return null;case"LineString":l<0&&(l=c.length+l-1);return r([c[l],c[l+1]],u,n);case"Polygon":i<0&&(i=c.length+i);l<0&&(l=c[i].length+l-1);return r([c[i][l],c[i][l+1]],u,n);case"MultiLineString":a<0&&(a=c.length+a);l<0&&(l=c[a].length+l-1);return r([c[a][l],c[a][l+1]],u,n);case"MultiPolygon":a<0&&(a=c.length+a);i<0&&(i=c[a].length+i);l<0&&(l=c[a][i].length-l-1);return r([c[a][i][l],c[a][i][l+1]],u,n)}throw new Error("geojson is invalid")}function findPoint(e,r){r=r||{};if(!t(r))throw new Error("options is invalid");var o=r.featureIndex||0;var a=r.multiFeatureIndex||0;var i=r.geometryIndex||0;var l=r.coordIndex||0;var u=r.properties;var s;switch(e.type){case"FeatureCollection":o<0&&(o=e.features.length+o);u=u||e.features[o].properties;s=e.features[o].geometry;break;case"Feature":u=u||e.properties;s=e.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":s=e;break;default:throw new Error("geojson is invalid")}if(s===null)return null;var c=s.coordinates;switch(s.type){case"Point":return n(c,u,r);case"MultiPoint":a<0&&(a=c.length+a);return n(c[a],u,r);case"LineString":l<0&&(l=c.length+l);return n(c[l],u,r);case"Polygon":i<0&&(i=c.length+i);l<0&&(l=c[i].length+l);return n(c[i][l],u,r);case"MultiLineString":a<0&&(a=c.length+a);l<0&&(l=c[a].length+l);return n(c[a][l],u,r);case"MultiPolygon":a<0&&(a=c.length+a);i<0&&(i=c[a].length+i);l<0&&(l=c[a][i].length-l);return n(c[a][i][l],u,r)}throw new Error("geojson is invalid")}export{coordAll,coordEach,coordReduce,featureEach,featureReduce,findPoint,findSegment,flattenEach,flattenReduce,geomEach,geomReduce,lineEach,lineReduce,propEach,propReduce,segmentEach,segmentReduce};

