import{cleanCoords as r}from"@turf/clean-coords";import{clone as n}from"@turf/clone";import{geomEach as t}from"@turf/meta";import{isObject as o}from"@turf/helpers";function e(r,n){var t=r[0]-n[0],o=r[1]-n[1];return t*t+o*o}function i(r,n,t){var o=n[0],e=n[1],i=t[0]-o,u=t[1]-e;if(i!==0||u!==0){var a=((r[0]-o)*i+(r[1]-e)*u)/(i*i+u*u);if(a>1){o=t[0];e=t[1]}else if(a>0){o+=i*a;e+=u*a}}i=r[0]-o;u=r[1]-e;return i*i+u*u}function u(r,n){var t,o=r[0],i=[o];for(var u=1,a=r.length;u<a;u++){t=r[u];if(e(t,o)>n){i.push(t);o=t}}o!==t&&i.push(t);return i}function a(r,n,t,o,e){var u,l=o;for(var f=n+1;f<t;f++){var c=i(r[f],r[n],r[t]);if(c>l){u=f;l=c}}if(l>o){u-n>1&&a(r,n,u,o,e);e.push(r[u]);t-u>1&&a(r,u,t,o,e)}}function l(r,n){var t=r.length-1;var o=[r[0]];a(r,0,t,n,o);o.push(r[t]);return o}function f(r,n,t){if(r.length<=2)return r;var o=n!==void 0?n*n:1;r=t?r:u(r,o);r=l(r,o);return r}function c(r,e={}){var i,u,a;e=e!=null?e:{};if(!o(e))throw new Error("options is invalid");const l=(i=e.tolerance)!=null?i:1;const f=(u=e.highQuality)!=null&&u;const c=(a=e.mutate)!=null&&a;if(!r)throw new Error("geojson is required");if(l&&l<0)throw new Error("invalid tolerance");c!==true&&(r=n(r));t(r,(function(r){s(r,l,f)}));return r}function s(n,t,o){const e=n.type;if(e==="Point"||e==="MultiPoint")return n;r(n,{mutate:true});if(e!=="GeometryCollection")switch(e){case"LineString":n.coordinates=f(n.coordinates,t,o);break;case"MultiLineString":n.coordinates=n.coordinates.map((r=>f(r,t,o)));break;case"Polygon":n.coordinates=h(n.coordinates,t,o);break;case"MultiPolygon":n.coordinates=n.coordinates.map((r=>h(r,t,o)))}return n}function h(r,n,t){return r.map((function(r){if(r.length<4)throw new Error("invalid polygon");let o=n;let e=f(r,o,t);while(!p(e)&&o>=Number.EPSILON){o-=o*.01;e=f(r,o,t)}if(!p(e))return r;e[e.length-1][0]===e[0][0]&&e[e.length-1][1]===e[0][1]||e.push(e[0]);return e}))}function p(r){return!(r.length<3)&&!(r.length===3&&r[2][0]===r[0][0]&&r[2][1]===r[0][1])}var m=c;export{m as default,c as simplify};

