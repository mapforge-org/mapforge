#share-modal.modal-center.fade
  .map-modal{'data-controller': "map--layers"}
    %button.close-button{ data: { action: "click->map--layers#close" } } &times;
    .map-modal-header
      %h3 Share Map

    .map-modal-content

      - if @map.user
        %p
          You can access this map via '#{link_to "your maps", my_path}'
      - else
        %p
          This map was created anonymously and can only get changed with the
          = link_to 'edit link', map_path(@map)
          = "."

      .row
        .col-md-3
          %button#share-edit-link.form-button.btn.btn-success{ type: "button" }
            =link_to map_path(@map) do
              %i.bi.bi-link-45deg
              Edit link
        .col-md-9
          .form-floating.edit-ui
            %label{ for: "map-edit-permissions"} Edit permissions:
            %select.form-select#map-edit-permissions{ "name": "map-visibility", "aria-label": "Edit permissions", data: { action: "input->map--layers#updateEditPermissions" }}
              %option{ value: 'private' } Only you
              %option{ value: 'link' } Everybody with the edit link

      .row.mb-2
        .col-md-3
          %button#share-view-link.form-button.btn.btn-success{ type: "button" }
            =link_to map_path(id: @map.public_id) do
              %i.bi.bi-link-45deg
              View link
        .col-md-9
          .form-floating.edit-ui
            %label{ for: "map-view-permissions"} View permissions:
            %select.form-select#map-view-permissions{ "name": "map-visibility", "aria-label": "View permissions", data: { action: "input->map--layers#updateViewPermissions" }}
              %option{ value: 'private' } Only you
              %option{ value: 'link' } Everybody with the view link
              %option{ value: 'public' } Everybody, map is shown on mapforge

      .btn-group-sm.mt-3{ role: "group" }
        %span.me-2 Download map as:
        %button.btn.btn-secondary{ type: "button" }
          =link_to map_path(@map.public_id, format: :geojson) do
            %i.bi.bi-download
            GeoJSON
        %button.btn.btn-secondary{ type: "button" }
          =link_to map_path(@map.public_id, format: :gpx) do
            %i.bi.bi-download
            GPX
        %button.btn.btn-secondary{ type: "button" }
          =link_to map_path(@map.public_id, format: :json) do
            %i.bi.bi-download
            Map export
