#layers-modal.modal-center.fade
  .map-modal{'data-controller': "map--layers", 'data-action': "keydown.esc@window->map--layers#close"}
    %button.close-button{ data: { action: "click->map--layers#close" } } &times;
    .map-modal-header
      %h3.mapforge-font Layers

    .map-modal-content

      - if @map_mode == 'rw'
        #layer-upload.row.align-items-center
          .col-12
            - if @user
              %label.form-control.btn.btn-green#file-input-label{ for: "fileInput" }
                %i.bi.bi-upload.me-1
                Import gpx/kml
              %input.hidden#fileInput{ type: "file", data: { action: "change->map--layers#upload" } }
              %i.no-wrap.ms-2
                %small WGS84 format, max. 800Kb
            - else
              %i.bi.bi-info-circle
                Please log in to upload tracks

      - # used by controls/shared.js
      .hidden
        #layer-item-template.layer-item.mt-3
          %h4
            %span.link{ data: { action: "click->map--layers#toggleLayerList" }}
              %i.bi.bi-caret-right-fill
              = image_tag "/icons/osm-icon-small.png", class: 'hidden layer-osm-icon', alt: "OSM Overpass layer"
              %span.mapforge-font.layer-name Layer name
            %button.hidden.btn.btn-green.btn-layer-actions.overpass-refresh{ data: { action: "click->map--layers#refreshOverpassLayer", "toggle": 'tooltip', 'bs-custom-class': 'maplibregl-ctrl-tooltip' }, title: "Refresh layer for current view" }
              %i.bi.bi-arrow-clockwise.reload-icon
            %button.hidden.btn.btn-light-green.btn-layer-actions.layer-edit{ data: { action: "click->map--layers#toggleEdit", "toggle": 'tooltip', 'bs-custom-class': 'maplibregl-ctrl-tooltip' }, title: "Edit query" }
              %i.bi.bi-pencil-square

          .layer-content.hidden

            .overpass-edit.mb-3.hidden
              %input.form-control.overpass-name{type: 'text', autocomplete: 'off', placeholder: 'Enter name / Search queries'}
              .autocomplete-list.dropdown-menu

              %textarea.form-control.overpass-query{name: 'overpass-query'}
              %button.btn.btn-green{ 'data-action': 'click->map--layers#updateOverpassLayer'}
                Update

            %ul.list-unstyled

      #layers.mt-2



